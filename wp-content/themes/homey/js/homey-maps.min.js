!function(f){"use strict";if("undefined"!=typeof HOMEY_map_vars){var h,y=HOMEY_map_vars.user_id,M=f("#listings_found"),E=HOMEY_map_vars.admin_url+"admin-ajax.php",w=HOMEY_map_vars.header_map_city,u=HOMEY_map_vars.markerPricePins,o=HOMEY_map_vars.pin_cluster,t=HOMEY_map_vars.pin_cluster_icon,n=HOMEY_map_vars.pin_cluster_zoom,O=HOMEY_map_vars.is_singular_listing,e=0,H=new Array,b=f("#homey_halfmap_listings_container"),Y=(new google.maps.InfoWindow,HOMEY_map_vars.google_map_style),k=HOMEY_map_vars.default_lat,I=HOMEY_map_vars.default_lng,d=HOMEY_map_vars.arrive,g=HOMEY_map_vars.depart,_=HOMEY_map_vars.guests,v=HOMEY_map_vars.pets,x=HOMEY_map_vars.search_country,z=HOMEY_map_vars.search_city,B=HOMEY_map_vars.search_area,L=HOMEY_map_vars.listing_type,T=HOMEY_map_vars.country,C=HOMEY_map_vars.state,P=HOMEY_map_vars.city,S=HOMEY_map_vars.area,D=HOMEY_map_vars.start_time,R=HOMEY_map_vars.end_time,j=HOMEY_map_vars.min_price,A=HOMEY_map_vars.max_price,Z=HOMEY_map_vars.keyword,N=HOMEY_map_vars.bedrooms,W=HOMEY_map_vars.rooms,G=HOMEY_map_vars.room_size,U=(S=HOMEY_map_vars.area,HOMEY_map_vars.animal),V=HOMEY_map_vars.terrain,F=HOMEY_map_vars.not_found,a=HOMEY_map_vars.infoboxClose,J=HOMEY_map_vars.bedrooms_icon,Q=HOMEY_map_vars.bathroom_icon,q=HOMEY_map_vars.guests_icon,K=f("#securityhomeyMap").val(),X=0,$=HOMEY_ajax_vars.compare_url,ee=HOMEY_ajax_vars.add_compare,ae=HOMEY_ajax_vars.remove_compare,oe=HOMEY_ajax_vars.compare_limit,te=!1;if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(te=!0),""!=Y)Y=JSON.parse(Y);if("yes"==u)var i=-30;else i=-70;var ne=new InfoBox({maxWidth:300,alignBottom:!0,disableAutoPan:!1,pixelOffset:new google.maps.Size(-160,i),zIndex:null,boxClass:"homeyInfobox",closeBoxMargin:"13px 2px -14px 2px",closeBoxURL:a,infoBoxClearance:new google.maps.Size(20,20),pane:"floatPane",enableEventPropagation:!1}),ie=function(e){if("yes"==o){var a=16;(n=parseInt(n))&&(a=n),new MarkerClusterer(e,H,{maxZoom:a,gridSize:60,styles:[{url:t,width:48,height:48,textColor:"#fff"}]})}},se=function(a){google.maps.event.addDomListener(document.getElementById("listing-mapzoomin"),"click",function(){var e=parseInt(a.getZoom(),10);console.log(e),20<++e&&(e=20),console.log("== "+e+" ++"),a.setZoom(e)})},le=function(a){google.maps.event.addDomListener(document.getElementById("listing-mapzoomout"),"click",function(){var e=parseInt(a.getZoom(),10);console.log(e),--e<0&&(e=0),console.log("== "+e+" -- "),a.setZoom(e)})};f(".homeyMapType").on("click",function(e){e.preventDefault(),function(e){"roadmap"===e?h.setMapTypeId(google.maps.MapTypeId.ROADMAP):"satellite"===e?h.setMapTypeId(google.maps.MapTypeId.SATELLITE):"hybrid"===e?h.setMapTypeId(google.maps.MapTypeId.HYBRID):"terrain"===e&&h.setMapTypeId(google.maps.MapTypeId.TERRAIN)}(f(this).data("maptype"))});f("#homey-gmap-next").on("click",function(){!function(){for(++e>H.length&&(e=1);!1===H[e-1].visible;)++e>H.length&&(e=1);console.log(e-1),google.maps.event.trigger(H[e-1],"click")}()}),f("#homey-gmap-prev").on("click",function(){!function(){for(--e<1&&(e=H.length);!1===H[e-1].visible;)--e>H.length&&(e=1);console.log(e-1),google.maps.event.trigger(H[e-1],"click")}()});var re=function(e,t){var a=new google.maps.places.SearchBox(e);t.controls[google.maps.ControlPosition.TOP_LEFT].push(e),t.addListener("bounds_changed",function(){a.setBounds(t.getBounds())});var n=[];a.addListener("places_changed",function(){var e=a.getPlaces();if(0!=e.length){n.forEach(function(e){e.setMap(null)}),n=[];var o=new google.maps.LatLngBounds;e.forEach(function(e){var a={url:e.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)};n.push(new google.maps.Marker({map:t,icon:a,title:e.name,position:e.geometry.location})),e.geometry.viewport?o.union(e.geometry.viewport):o.extend(e.geometry.location)}),t.fitBounds(o)}})},me=function(){for(var e=0;e<H.length;e++)H[e].setMap(null);H=[]},pe=function(e,_){f.each(e,function(e,a){var o=new google.maps.LatLng(a.lat,a.long),t=a.data?a.data.post_title:a.title;if("yes"==u)var n='<div data-id="'+a.id+'" class="gm-marker gm-marker-color-'+a.term_id+'"><div class="gm-marker-price">'+a.price+"</div></div>",i=new RichMarker({map:_,position:o,draggable:!1,flat:!0,anchor:RichMarkerPosition.MIDDLE,content:n});else{var s=a.icon,l=new google.maps.Size(44,56);1.5<window.devicePixelRatio&&a.retinaIcon&&(s=a.retinaIcon,l=new google.maps.Size(44,56));var r={url:s,size:l,scaledSize:new google.maps.Size(44,56)};i=new google.maps.Marker({position:o,map:_,icon:r,draggable:!1,title:t})}var m="",p="",c="",d="";""!=a.bedrooms&&(m="<li>"+J+'<span class="total-beds">'+a.bedrooms+"</span></li>"),""!=a.baths&&(p="<li>"+Q+'<span class="total-baths">'+a.baths+"</span></li>"),""!=a.guests&&(c="<li>"+q+'<span class="total-guests">'+a.guests+"</span></li>"),""!=a.listing_type&&(d='<li class="item-type">'+a.listing_type+"</li>");var g='<div id="google-maps-info-window"><div class="item-wrap item-grid-view"><div class="media property-item"><div class="media-left"><div class="item-media item-media-thumb"><a href="'+a.url+'" class="hover-effect">'+a.thumbnail+'</a><div class="item-media-price"><span class="item-price">'+a.price+'</span></div></div></div><div class="media-body item-body clearfix"><div class="item-title-head"><div class="title-head-left"><h2 class="title"><a href="'+a.url+'">'+t+'</a></h2><address class="item-address">'+a.address+'</address></div></div><ul class="item-animals">'+m+p+c+d+"</ul></div></div></div></div>";google.maps.event.addListener(i,"click",function(e){ne.setContent(g),ne.open(_,this)}),H.push(i)})},ce=function(e,a,o,t,n,i,s,l,r,m){if(null!=document.getElementById(o)){if(i=i||14,!s)s=0;var p,c="";if(l?p="homey_half_map":(p="homey_header_map","lat_long"==m||"city"==m&&(c=w)),h=new google.maps.Map(document.getElementById(o),{zoom:i,zoomControl:!1,mapTypeControl:!1,streetViewControl:!1,overviewMapControl:!1,scrollwheel:!1,fullscreenControl:!0,fullscreenControlOptions:{position:google.maps.ControlPosition.RIGHT_BOTTOM},center:new google.maps.LatLng(e,a),mapTypeId:"roadmap",gestureHandling:"cooperative",styles:Y}),l)var d=r;else d={action:p,map_cities:c,security:K};google.maps.event.addListenerOnce(h,"idle",function(){_(E,d),g()});var g=function(){1==s&&google.maps.event.addListener(h,"dragend",function(){var e={action:p,map_cities:c,security:K,optimized_loading:1,north_east_lat:h.getBounds().getNorthEast().lat(),north_east_lng:h.getBounds().getNorthEast().lng(),south_west_lat:h.getBounds().getSouthWest().lat(),south_west_lng:h.getBounds().getSouthWest().lng()};_(E,e)})},_=function(a,e){f.ajax({url:a,dataType:"json",method:"POST",data:e,beforeSend:function(){f("#homey-map-loading").show(),l&&b.empty().append('<div id="homey-map-loading"><div class="mapPlaceholder"><div class="loader-ripple spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div></div>')},success:function(e){!0===e.getListings?(me(),pe(e.listings,h),l&&(b.empty().html(e.listingHtml),M.empty().html(e.total_results),te||f(".infobox_trigger").each(function(e){f(this).on("mouseenter",function(){google.maps.event.trigger(H[e],"click")}),f(this).on("mouseleave",function(){ne.open(null,null)})})),s||u(),ie(h),homey_init_add_favorite(a,y,O),homey_init_remove_favorite(a,y,O),function(){var e=homeyGetCookie("homey_compare_listings");add_to_compare($,ee,ae,oe,e,4),remove_from_compare(e,ee,ae)}(),l&&(ue(),f(".half-map-left-wrap, .half-map-right-wrap").animate({scrollTop:0},"slow")),f("#homey-map-loading").hide()):(me(),h.setCenter(new google.maps.LatLng(k,I)),f("#homey-halfmap").append('<div class="map-notfound">'+F+"</div>"),b.empty().html('<div class="map-notfound">'+F+"</div>"),M.empty().html(e.total_results))},error:function(e){console.log(e)}})},u=function(){h.fitBounds(H.reduce(function(e,a){return e.extend(a.getPosition())},new google.maps.LatLngBounds));var e=parseInt(h.getZoom(),10);20<e&&(e=14),h.setZoom(e)};if(document.getElementById("listing-mapzoomin")&&se(h),document.getElementById("listing-mapzoomout")&&le(h),document.getElementById("google-map-search")){var v=document.getElementById("google-map-search");re(v,h)}}else console.log("No map element found")},s=function(e,a,o,t,n,i,s,l,r,m){var p=f("#homey-halfmap");d=e.find('input[name="arrive"]').val(),g=e.find('input[name="depart"]').val(),_=e.find('input[name="guest"]').val(),Z=e.find('input[name="keyword"]').val(),v=e.find('input[name="pets"]:checked').val(),B=e.find('input[name="search_area"]').val(),z=e.find('input[name="search_city"]').val(),x=e.find('input[name="search_country"]').val(),L=e.find('select[name="listing_type"]').val(),T=e.find('select[name="country"]').val(),C=e.find('select[name="state"]').val(),P=e.find('select[name="city"]').val(),S=e.find('select[name="area"]').val(),D=e.find('select[name="start"]').val(),R=e.find('select[name="end"]').val(),""!=L&&null!=L||(L=p.data("type")),U=e.find(".animals-list input[type=checkbox]:checked").map(function(e,a){return f(a).val()}).toArray(),V=e.find(".terrains-list input[type=checkbox]:checked").map(function(e,a){return f(a).val()}).toArray(),j=e.find('select[name="min-price"]').val(),A=e.find('select[name="max-price"]').val(),N=e.find('select[name="bedrooms"]').val(),W=e.find('select[name="rooms"]').val(),G=e.find('select[name="room_size"]').val();var c=f("#sort_listings_halfmap").val();null!=a&&(X=a);ce(o,t,n,0,0,l,r,m,{action:"homey_half_map",arrive:d,depart:g,guest:_,keyword:Z,pets:v,bedrooms:N,rooms:W,room_size:G,search_country:x,search_city:z,search_area:B,listing_type:L,"min-price":j,"max-price":A,country:T,state:C,city:P,area:S,start_hour:D,end_hour:R,animal:U,terrain:V,sort_by:c,layout:de,num_posts:ge,paged:a,security:K},"")};if(0<f("#banner-map").length){var l=(we=f("#banner-map")).data("zoomlevel"),r=we.data("maptype");we.data("lat"),we.data("long");ce(ye="",Me="",Oe="banner-map",0,0,He=l,_e=0,c=!1,null,r)}if(0<f("#homey-halfmap").length){l=(we=f("#homey-halfmap")).data("zoom");var de=we.data("layout"),ge=we.data("num-posts"),m=we.data("order"),p=we.data("type");""==L&&(L=p);var c,_e;ce(ye="",Me="",Oe="homey-halfmap",0,0,He=l,_e=0,c=!0,{action:"homey_half_map",arrive:d,depart:g,guest:_,keyword:Z,pets:v,bedrooms:N,rooms:W,room_size:G,search_country:x,search_city:z,search_area:B,listing_type:L,"min-price":j,"max-price":A,country:T,state:C,city:P,area:S,start_hour:D,end_hour:R,animal:U,terrain:V,layout:de,num_posts:ge,sort_by:m,paged:X,security:K},r=""),f(".homey_half_map_search_btn").on("click",function(e){e.preventDefault();var a=f(this).parents(".half-map-wrap");s(a,1,ye,Me,Oe,0,0,He,_e,c)}),f("#sort_listings_halfmap").on("change",function(e){e.preventDefault();var a=f(this).parents(".half-map-wrap");s(a,1,ye,Me,Oe,0,0,He,_e,c)});var ue=function(){return f(".half_map_ajax_pagi a").on("click",function(e){e.preventDefault();var a=f(this).data("homeypagi"),o=f(this).parents(".half-map-wrap");s(o,a,ye,Me,Oe,0,0,He,_e,c)}),!1}}if(0<f("#homey-single-map").length){l=(we=f("#homey-single-map")).data("zoom");var ve=we.data("pin-type"),fe=we.data("marker-pin"),he=we.data("marker-pin-retina"),ye=we.data("lat"),Me=we.data("long");if("marker"==ve)var Ee=!1;else Ee=!0;!function(e,a,o,t,n,i,s,l){var r;n=n||!1,i=i||15;r=new google.maps.LatLng(e,a);var m,p,c;p={zoom:i,center:r,disableDefaultUI:!1,gestureHandling:"cooperative",styles:Y},c=document.getElementById(o),h=new google.maps.Map(c,p),n||function(e){var a=s,o=new google.maps.Size(44,56);1.5<window.devicePixelRatio&&l&&(a=l,o=new google.maps.Size(44,56));var t={url:a,size:o,scaledSize:new google.maps.Size(44,56)};new google.maps.Marker({position:e.getCenter(),map:e,icon:t,draggable:!1,animation:google.maps.Animation.DROP})}(h),n&&(m=h,new google.maps.Circle({strokeColor:"#4f5962",strokeOpacity:.8,strokeWeight:2,fillColor:"#4f5962",fillOpacity:.35,map:m,center:r,radius:500}))}(ye,Me,Oe="homey-single-map",0,Ee,He=l,fe,he)}if(0<f("#homey_sticky_map").length){var we=f("#homey_sticky_map"),Oe="homey_sticky_map",He=12,be=we.data("mappaged");!function(e,a,o,t){if(null!=document.getElementById(e)){o=o||14;h=new google.maps.Map(document.getElementById(e),{zoom:o,zoomControl:!1,mapTypeControl:!1,streetViewControl:!1,overviewMapControl:!1,scrollwheel:!1,fullscreenControl:!0,fullscreenControlOptions:{position:google.maps.ControlPosition.RIGHT_BOTTOM},center:new google.maps.LatLng("",""),mapTypeId:"roadmap",gestureHandling:"cooperative",styles:Y});var n={action:"homey_sticky_map",paged:t,security:K};google.maps.event.addListenerOnce(h,"idle",function(){i(E,n)});var i=function(e,a){f.ajax({url:e,dataType:"json",method:"POST",data:a,success:function(e){!0===e.getListings&&(me(),pe(e.listings,h),s(),ie(h),f("#homey-map-loading").hide())},error:function(e){console.log(e)}})},s=function(){h.fitBounds(H.reduce(function(e,a){return e.extend(a.getPosition())},new google.maps.LatLngBounds))};if(document.getElementById("listing-mapzoomin")&&se(h),document.getElementById("listing-mapzoomout")&&le(h),document.getElementById("google-map-search")){var l=document.getElementById("google-map-search");re(l,h)}}else console.log("No map element found")}(Oe,0,He,be)}f("#homey-gmap-full").on("click",function(){f('div.gm-style button[title="Toggle fullscreen view"]').trigger("click")})}}(jQuery);